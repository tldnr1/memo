# db 공부한 내용 정리
last update : 2024.09.04 (수)
<br>
<br>
참고자료 : [DB 설게는 어떻게 해야할까?](https://velog.io/@sontulip/how-to-db-design)

## Database는 "돈"을 많이 벌어다 주는 것이 좋다!
### 왜 "돈"인가?
- 회사의 입장에서 '돈'을 번다는 것은 다음의 3가지가 있다
  - 서비스 이용자를 통한 수익
  - 비용 절감
  - 개발 시간 단축
- 그럼 좋은 db 설계가 필요한 이유는? '돈을 벌어주기 때문' 이다.
```
A라는 설계안은 저장공간을 아껴줍니다. 이외에도 수많은 장점과 단점이 있습니다.
B라는 설계안은 성능을 높혀줍니다. 이외에도 수많은 장점과 단점이 있습니다.

위와 같은 경우 기준이 '돈'으로 통일되어 있다면, '돈을 많이 벌어주는' 것을 고르면 된다!
```

### 좋지 않은 Database란?
- 좋지 않은 설계를 가진 db의 문제점
  1. 정확하지 않은 데이터 포함 > 문제 파악, 데이터 변경 등의 작업동안 서비스 정지 => 비용이 많이 든다
  2. 작은 요구사항 변경을 위한 대량의 db 변경 > 개발자의 시간 + 서비스 정지 => 비용이 많이 든다
  3. 비효율적인 db 구조로 인해 서비스 이용자 감소 => 수익의 감소

### 그럼 좋은 Database는?
- **무결성** - 데이터베이스 내에 모든 값은 언제나 ***정확한 값을 유지***해야 한다.
- **유연성** - 데이터베이스 구조는 ***요구사항 변화에 대해 수정***이 쉬워야 한다.
- **확장성** - 데이터베이스 구조는 ***기능 확장에 대해서 수정***이 쉬워야 한다.
- 단, '성능'은 **무결성**을 해치는 결과를 낳을 가능성이 높기에 가장 마지막에 고려한다.<br> 이후 성능이 정말 문제가 될 떄 개선을 진행한다.
<br><br><br>

## 테이블 설계
1. 예비 테이블 만들기
   <br> - 예비 필드 목록 뽑고, 이를 적절히 묶어 예비 테이블 만들기
   <br> - 유사 서비스를 찾아보고 더 필요한 데이터 생각해보기
   <br>

2. 이상적인 테이블 구조에 따라 테이블 구상하기
   1. 개체 또는 사건일 수 있는 **단일 주제**를 나타낸다
   <br> - 대부분의 문제가 테이블이 여러 주제를 나타낼 때 발생
   <br> - '유저', '상품' 등이 개체 / '주문 기록', '결제 기록' 등이 사건
   <br>

   2. 기본 key를 **자연키 vs 인조키?**
   <br> - 자연키 : 자연적으로 존재하는 데이터 속성 (e.g. 이메일 주소, 전화번호 등)
   <br> - 인조키 : 인위적으로 생성되는 고유 식별자 (DB에서 자동으로 부여)
   <br> 이 경우, '성능'을 중시하지 않도록 주의! **항상 무결성, 유연성, 확장성 먼저!**
   <br>

3. 포함하지 않아야 할 값들
   <br> - 다중값 필드 : '사진들' 처럼 한 필드에 여러 값이 들어가는 경우
   <br> - 다중부분 필드 : '주소'의 시,군,동 처럼 하나의 필드가 여러 필드로 나뉘는 경우 (필요에 따라 조치)
   <br> - 계산된 필드 : '최종 금액'처럼 다른 필드 들의 값에 의해 결정되는 필드 (계산의 영역이 응용프로그램으로 넘어가기에 별로임)
   <br> - 중복 데이터 : 외래키 혹은 '등급'과 같이 하나의 수정이 여러 레코드의 수정을 초래하는 경우를 방지
   <br>

4. 필드 명세 설정
   1. CHAR vs. VARCHAR (이름, 비밀번호, url, 내용 등)
   <br> - CHAR : 고정길이, 저장공간 낭비
   <br> - VARCHAR : 가변길이, 수정능력 저하(디스크 저장위치 이동 필요)
   <br>Con. 수정능력 vs. 조회성능 으로 귀결되기 때문에 조회성능이 더 좋은 VARCHAR 우세 (웹에서는 조회가 수정, 삽입, 삭제에 비해 8:2 정도로 조회가 많이 발생) 
5. (아직 덜 적음)